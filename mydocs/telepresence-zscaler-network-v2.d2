# Telepresence + Zscaler Zero Trust Network Architecture v2

direction: right

# Define styles for keynote presentation
vars: {
  d2-config: {
    layout-engine: elk
    pad: 50
  }
}

# Title
title: |md
  # Advanced Telepresence + Zscaler Architecture
  ## Enhanced Security & Development Flow
| {style: {font-size: 28}}

# Step 1: Enhanced Developer Workstation
dev_workstation: {
  shape: rectangle
  label: "Step 1: Enhanced Developer Environment"
  style: {
    fill: "#F8F9FA"
    stroke: "#C8C8CC"
    stroke-width: 3
    border-radius: 24
    font-size: 20
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  browser_apps: Browser & Apps {
    shape: rectangle
    style: {
      fill: "#FFFFFF"
      stroke: "#E5E5EA"
      stroke-width: 2
      border-radius: 16
      font-size: 16
      shadow: true
      3d: true
    }
  }
  
  telepresence_enhanced: Telepresence Client\n(Enhanced) {
    shape: package
    style: {
      fill: "#E4F5E9"
      stroke: "#34C759"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
    
    user_daemon: User Daemon {
      shape: step
      style: {font-size: 14}
    }
    
    root_daemon: Root Daemon {
      shape: step
      style: {font-size: 14}
    }
  }
  
  kubectl_advanced: kubectl CLI\n(Advanced) {
    shape: rectangle
    style: {
      fill: "#DDEEFE"
      stroke: "#0A84FF"
      stroke-width: 2
      border-radius: 16
      font-size: 16
      shadow: true
      3d: true
    }
  }
  
  zscaler_enhanced: Zscaler Client\n(Enhanced) {
    shape: package
    style: {
      fill: "#FFF3E0"
      stroke: "#FF9500"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
    
    zpa_module: ZPA Module {
      shape: step
      style: {font-size: 14}
    }
    
    zia_module: ZIA Module {
      shape: step
      style: {font-size: 14}
    }
  }
}

# Step 2: Advanced DNS Management
dns_management: {
  shape: rectangle
  label: "Step 2: Advanced DNS Management"
  style: {
    fill: "#FAFAFA"
    stroke: "#8E8E93"
    stroke-width: 3
    border-radius: 24
    font-size: 20
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  internal_dns_server: Internal DNS Server\n127.0.0.1:53 {
    shape: cylinder
    style: {
      fill: "#E4F5E9"
      stroke: "#34C759"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
  }
  
  cluster_resolution: |md
    **Cluster Domains:**
    • *.cluster.local
    • *.svc
    • service names
  | {
    shape: text
    style: {
      font-size: 14
      font-color: "#34C759"
      italic: true
    }
  }
  
  external_dns_server: External DNS\nvia Zscaler ZIA {
    shape: cylinder
    style: {
      fill: "#FFF3E0"
      stroke: "#FF9500"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
  }
  
  public_resolution: |md
    **Public Domains:**
    • *.com
    • *.io
    • *.net
    • *.org
  | {
    shape: text
    style: {
      font-size: 14
      font-color: "#FF9500"
      italic: true
    }
  }
}

# Step 3: Enhanced Security Architecture
security_architecture: {
  shape: rectangle
  label: "Step 3: Enhanced Security Architecture"
  style: {
    fill: "#FFF8E1"
    stroke: "#FF9500"
    stroke-width: 3
    border-radius: 24
    font-size: 20
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  zpa_edge: ZPA Service Edge\n(Zero Trust) {
    shape: hexagon
    style: {
      fill: "#FFFFFF"
      stroke: "#FF9500"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
  }
  
  zia_edge: ZIA Service Edge\n(Web Security) {
    shape: hexagon
    style: {
      fill: "#FFFFFF"
      stroke: "#FF9500"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
  }
  
  identity_provider: Microsoft Entra ID\n(Identity Provider) {
    shape: cylinder
    style: {
      fill: "#0078D4"
      stroke: "#0078D4"
      stroke-width: 2
      font-size: 16
      font-color: "#FFFFFF"
      bold: true
      shadow: true
    }
  }
  
  security_policies: |md
    **Security Policies:**
    • Zero Trust Access
    • Developer Groups
    • Access Controls
  | {
    shape: text
    style: {
      font-size: 14
      font-color: "#FF9500"
      italic: true
    }
  }
}

# Step 4: Advanced Kubernetes Platform
k8s_platform: {
  shape: rectangle
  label: "Step 4: Advanced Kubernetes Platform"
  style: {
    fill: "#E3F2FD"
    stroke: "#326CE5"
    stroke-width: 3
    border-radius: 24
    font-size: 20
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  api_server_enhanced: Kubernetes API\n192.168.122.27:6443 {
    shape: hexagon
    style: {
      fill: "#FFFFFF"
      stroke: "#326CE5"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
  }
  
  traffic_manager_enhanced: Traffic Manager\n(Ambassador) {
    shape: queue
    style: {
      fill: "#FFFFFF"
      stroke: "#34C759"
      stroke-width: 3
      border-radius: 16
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
    }
  }
  
  service_mesh: Service Mesh\n(10.43.0.0/16) {
    shape: package
    style: {
      fill: "#FFFFFF"
      stroke: "#326CE5"
      stroke-width: 2
      font-size: 16
      font-color: "#1D1D1F"
      shadow: true
    }
  }
  
  observable_framework: Observable Framework\n(Enhanced) {
    shape: circle
    style: {
      fill: "#FFFFFF"
      stroke: "#326CE5"
      stroke-width: 3
      font-size: 16
      font-color: "#1D1D1F"
      bold: true
      shadow: true
      double-border: true
    }
  }
}

# Step 5: Enhanced Applications & Internet
applications_internet: {
  shape: rectangle
  label: "Step 5: Applications & Internet Access"
  style: {
    fill: "#F8F9FA"
    stroke: "#8E8E93"
    stroke-width: 3
    border-radius: 24
    font-size: 20
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  secure_internet: Secure Internet\n(Filtered) {
    shape: cloud
    style: {
      fill: "#FFFFFF"
      stroke: "#8E8E93"
      stroke-width: 2
      font-size: 16
      font-color: "#1D1D1F"
      shadow: true
      multiple: true
    }
  }
  
  live_dashboard_enhanced: Live Dashboard\nlocalhost:3000\n(Enhanced UX) {
    shape: rectangle
    style: {
      fill: "#34C759"
      stroke: "#34C759"
      stroke-width: 2
      font-size: 16
      font-color: "#FFFFFF"
      bold: true
      border-radius: 16
      shadow: true
      3d: true
    }
  }
  
  k8s_services: Kubernetes Services\n(Available to All) {
    shape: rectangle
    style: {
      fill: "#326CE5"
      stroke: "#326CE5"
      font-size: 16
      font-color: "#FFFFFF"
      bold: true
      border-radius: 16
      shadow: true
    }
  }
}

# Enhanced Flow Connections

# Step 1 → Step 2: Enhanced DNS Resolution
dev_workstation.telepresence_enhanced -> dns_management.internal_dns_server: "1. Enhanced Cluster DNS\n*.cluster.local Resolution" {
  style: {
    stroke: "#34C759"
    stroke-width: 5
    font-size: 14
    font-color: "#34C759"
    bold: true
  }
}

dev_workstation.zscaler_enhanced -> dns_management.external_dns_server: "2. Secure Public DNS\nvia Zscaler ZIA" {
  style: {
    stroke: "#FF9500"
    stroke-width: 5
    font-size: 14
    font-color: "#FF9500"
    bold: true
  }
}

# Step 2 → Step 3: Enhanced Security Processing
dns_management.external_dns_server -> security_architecture.zia_edge: "3. Advanced Web Filtering\n& DNS Security" {
  style: {
    stroke: "#FF9500"
    stroke-width: 5
    font-size: 14
    font-color: "#FF9500"
    bold: true
  }
}

security_architecture.identity_provider -> security_architecture.zpa_edge: "4. Enhanced Identity\n& Policy Enforcement" {
  style: {
    stroke: "#0078D4"
    stroke-width: 4
    font-size: 14
    font-color: "#0078D4"
    stroke-dash: 3
    bold: true
  }
}

# Step 3 → Step 4: Enhanced Kubernetes Access
dev_workstation.kubectl_advanced -> k8s_platform.api_server_enhanced: "5. Direct Kubernetes\nAPI Access (Enhanced)" {
  style: {
    stroke: "#0A84FF"
    stroke-width: 5
    font-size: 14
    font-color: "#0A84FF"
    bold: true
  }
}

dev_workstation.telepresence_enhanced -> k8s_platform.traffic_manager_enhanced: "6. Enhanced Telepresence\nConnection & Traffic" {
  style: {
    stroke: "#34C759"
    stroke-width: 5
    font-size: 14
    font-color: "#34C759"
    bold: true
  }
}

# Step 4 → Step 5: Enhanced Application Access
k8s_platform.traffic_manager_enhanced -> k8s_platform.observable_framework: "7. Enhanced Traffic\nInterception & Routing" {
  style: {
    stroke: "#34C759"
    stroke-width: 4
    font-size: 14
    stroke-dash: 3
  }
}

k8s_platform.observable_framework -> applications_internet.live_dashboard_enhanced: "8. Enhanced Live Dashboard\nAccess & Interaction" {
  style: {
    stroke: "#34C759"
    stroke-width: 5
    font-size: 14
    font-color: "#34C759"
    bold: true
  }
}

k8s_platform.observable_framework -> applications_internet.k8s_services: "9. Service Exposure\nvia Kubernetes" {
  style: {
    stroke: "#326CE5"
    stroke-width: 4
    font-size: 14
    font-color: "#326CE5"
    bold: true
  }
}

security_architecture.zia_edge -> applications_internet.secure_internet: "10. Secure & Filtered\nInternet Access" {
  style: {
    stroke: "#FF9500"
    stroke-width: 5
    font-size: 14
    font-color: "#FF9500"
    bold: true
  }
}

# Enhanced Architecture Benefits
architecture_benefits: {
  shape: text
  label: "Enhanced Architecture Benefits"
  style: {
    fill: "#E4F5E9"
    stroke: "#34C759"
    stroke-width: 2
    border-radius: 20
    font-size: 18
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  benefits_list: |md
    **🚀 Enhanced Development:**
    • Advanced Telepresence integration
    • Enhanced debugging capabilities
    • Improved developer experience
    
    **🔒 Advanced Security:**
    • Zero Trust architecture
    • Enhanced identity verification
    • Advanced threat protection
    
    **☸️ Kubernetes Excellence:**
    • Direct API server access
    • Enhanced service mesh
    • Improved observability
    
    **🌐 Seamless Connectivity:**
    • Optimized DNS resolution
    • Enhanced traffic management
    • Improved network performance
  | {style: {font-size: 14}}
}

# Configuration Requirements
config_requirements: {
  shape: text
  label: "Enhanced Configuration Requirements"
  style: {
    fill: "#F5F5F7"
    stroke: "#D1D1D6"
    stroke-width: 2
    border-radius: 20
    font-size: 18
    font-color: "#1D1D1F"
    bold: true
    shadow: true
  }
  
  requirements: |md
    **🔧 Enhanced Zscaler Configuration:**
    • DNS Bypass: 127.0.0.1:53 (Enhanced Telepresence)
    • Network Bypass: 10.43.0.0/16, 10.42.0.0/24
    • API Server: 192.168.122.27/32
    
    **🌐 Advanced DNS Configuration:**
    • *.cluster.local → Enhanced Telepresence DNS
    • *.com, *.io, *.net → Enhanced Zscaler ZIA
    
    **🔒 Enhanced Security Configuration:**
    • Internet traffic → Advanced Zscaler filtering
    • Kubernetes access → Direct enhanced connection
    • Identity management → Microsoft Entra ID integration
    • Zero Trust policies → Developer group enforcement
  | {style: {font-size: 14}}
}

# Flow visualization for presentations
enhanced_flow_title: {
  shape: text
  label: "Enhanced Traffic Flow: Developer Environment → DNS Management → Security Architecture → Kubernetes Platform → Applications & Internet"
  style: {
    font-size: 18
    font-color: "#007AFF"
    bold: true
  }
}